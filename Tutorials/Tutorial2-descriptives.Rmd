---
title: "Tutorial 2 - Circular descriptives"
author: "Arjan Huizing"
output:
  html_document: default
  pdf_document: default
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(circular)
```

## Getting started in R

In the previous tutorial we discussed what circular data is and how it is measured. In this tutorial we will start analyzing circular data. For the analyses of circular data we will be using the open source programming language R. R is available for Windows, MacOS and Linux, and can be downloaded from <https://cran.r-project.org/>. 

&nbsp;

One tool that can be used to analyze and plot circular data is the package `circular` in R. To install and load this package the following code can be used
```{r message=FALSE, warning=FALSE, eval=FALSE}
install.packages("circular")
library(circular)
```

For circular data there are two units of measurement that are commonly used, degrees and radians. A circle has a total of 360 degrees, or equivalently, a total of \(2 \pi\) (\(\approx 6.28\)) radians. Values cannot exceed this total, and if they do most functions will automatically scale them back to the circular range (e.g. 361 degrees equals 1 degree). To showcase this, we specify one datasets containing the observations \([0,2,4,6,8]\). We can enter this data into R using the function `as.circular`. The argument `units` can be used to specify the measurement type in either degrees or radians.
```{r echo=TRUE, message=FALSE, warning=FALSE}
data.deg <- as.circular(c(0, 2, 4, 6, 8), units = "degrees")
data.rad <- as.circular(c(0, 2, 4, 6, 8), units = "radians")
```

```{r echo=FALSE}
par(mfrow = c(1,2))
plot(data.deg, main = "Observations in degrees")
plot(data.rad, main = "Observations in radians")
```
*The dataset in degrees and the dataset in radians plotted on the circle.*

If the data is measured in degrees the observations will be concentrated on one side of the circle, as the circular range extends from zero to 360. If the data is measured in radians however, the data will be spread across the entire circular range of \(2\pi\). The value of 8 will exceed this maximum and is thus calculated as `r round(8%%(2*pi), digits = 2)`.

Visually we can see these two datasets are completely different. This shows that we must be very careful: the data entered in `as.circular` must match the units that are given. In R we can always convert our values from radians to degrees and vice versa using the function `conversion.circular`. 

```{r, eval = FALSE}
data.rad <- conversion.circular(data.deg, units = "radians")
```


## The mean direction

A mean value in circular data is referred to as the *mean direction*. For example, the mean direction in a dataset with observations on a compass pointing north (\(0 ^\circ\)) and east (\(90 ^\circ\)) would be northeast (\(45 ^\circ\)). Although intuitively this makes sense, it often is not as straightforward to calculate as the mean in linear data. Unlike in linear data, it is not possible to take the sum of all values and divide them by the total number of observations. If one would have a dataset with an observation of \(350 ^\circ\) and \(10 ^\circ\) then the mean direction on the circle will be drastically different from the linear mean.

Given a dataset with a total number of \(n\) obersvations \(\theta\), the mean direction of \(\theta\) values requires us to calculate the sum of cosines (\(C = \sum \text{cos} \theta_i \)), the sum of sines (\(S = \sum \text{sin} \theta_i \)) and \(R = \sqrt{C^2 + S^2} \), which is the square root of the sum of squared $C$ and $S$ values. The mean direction is then given by Fisher (1995):

\begin{align}
  \overline{\theta}  &= 
    \begin{cases}
      tan^{-1} (S/C)                   &  S > 0, C > 0\\ 
      tan^{-1} (S/C) + \pi             &  C < 0\\ 
      tan^{-1} (S/C) + 2\pi            &  S < 0, C > 0\\ 
    \end{cases}
\end{align}
\

The mean direction can easily be computed in R. The package `circular` contains the function `mean.circular`, which integrates with the base R function for calculating the mean.

```{r message=FALSE, warning=FALSE, paged.print=FALSE}
mean(data.rad)
```

```{r, include=FALSE}
mean_rad <- mean(data.rad)
```

As we can see, the mean direction of values in radians are very different from the linear mean of \([0,2,4,6,8]\). Where the regular mean simply takes the sum of all values and divides them by the total amount of values, the mean direction takes account of the fact that the data is defined on a circular continuum. 

One peculiarity with the mean direction is that it can be undefined. On rare occassions it is possible that all values are cancelled out by opposite values, resulting in an undefined mean direction. For example, what is the mean direction of north and south: east or west?


## Measures of concentration and spread

The mean direction is a measure of location, just like the mean in linear data. Similarly, we can also obtain descriptives that are a measure of spread or concentration. These indicate how much variation there is in observations, similar to the variance in linear data.

The mean resultant length (\(\bar{R}\)) is one such measure, and is obtained by \(\overline{R} = R/n\), where \(R = \sqrt{C^2 + S^2} \).
This is a measure of *concentration* that can take on values between zero and one. The value 1 indicates that all values of the dataset are concentrated at a single location. A value close to zero indicates a higher spread. Interestingly enough, zero itself does not necessarily mean complete dispersion but can also be caused by having two sets of observations on opposite ends on the circle. It is therefore wise to plot the distribution of circular data before drawing any conclusions about the concentration of datapoints. More on this in the third tutorial on distributional assumptions.

The mean resultant length can be calculated using `rho.circular`. 

```{r}
rho.circular(data.deg)
```

A mean resultant length of \(\bar{R} \approx .248\) indicates a somewhat low concentration.

Other than the mean direction and mean resultant length, we can also obtain a circular variance and a circular standard error. 

Since the mean resultant length is a measure of concentration and the variance is traditionally a measure of spread, the variance in circular data (\(V_m\)) is simply 1 minus the mean resultant length. Its interpretation is opposite to that of the mean resultant length. The function `var.circular` will give you this value, but it is also easily obtained by \(1 - \rho\). The standard deviation (\(v\)) is *not* obtained using the square root of the variance, but rather using \((-2 \log\ (1-var))^{1/2}\).

```{r}
var(data.deg)
sd(data.deg)
```

As we can see the variance is indeed just $\bar{R}$ - 1. The standard deviation is 1.67. The circular package always returns this value in radians. Since our original dataset is in degrees, for easier interpretation we can choose to convert the value. 

```{r}
1.67*(180/pi)
```
The standard deviation is approximately \(95.7^\circ\). One standard devation below the mean direction is \(240.5^\circ\), and one standard devation above the mean direction is \(71.9^\circ\).


## Conclusion

The mean direction (\(\bar{\theta}\)), mean resultant length (\(\bar{R}\)), variance (\(V_m\)) and standard deviation (\(v\)) are ways to describe location and spread in circular data. These measures are however not always reliable. For that reason, it is recommended one always plots their data and inspects it visually as well. In the next tutorial, we will discuss why these measures are not always reliable by going into the distributional assumptions. We will also cover how to plot circular data in R.

## References
Fisher, N. I. (1995). *Statistical analysis of circular data.* Cambridge University Press.