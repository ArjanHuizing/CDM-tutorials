---
title: "Tutorial 3 - Plots and distributions"
author: "Arjan Huizing"
output:
  pdf_document: default
  word_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(circular)
```

##Introduction

It is important to investigate the way that data is distributed. Not only do many models assume that data has a certain distribution, even simple descriptives such as the median or mean may paint a incorrect picture of our data if we take them at face value. 

When we analyse circular data it is just as important that we visualize the distribution of data points. In the previous tutorial we noted it was possible for mean directions to be undefined and for mean resultant lengths to indicate a very low concentration even when in our data this may not be the case. For example, take the dataset specified below. 

```{r message=FALSE, warning=FALSE, paged.print=FALSE}
example <- as.circular(c(350, 355, 0, 5, 10, 
                         190, 185, 180, 175, 170), units = "degrees")
mean(example)
rho.circular(example)
```

The mean direction returns `NA` indicating it is not defined. Additionally, the mean resultant length is practically equal to zero. This value would lead us to believe that the data is spread entirely across the circle. However, when inspecting the actual distribution we can see that there are two modal groups on opposite ends of the circle.

```{r echo=FALSE}
plot(example, main = "Dataset with two exact opposite modal groups")
```

In this example, exact opposites were used. Similar problems also arise when data is distributed in two largely opposite groups. We will still find a mean resultant length close to zero even though the data is not evenly spread across the circle. We will obtain a mean direction, however the mean direction is not indicative for the actual location of the data and may also drastically shift due to small changes in observed values.

##Distributions on the circle

Generally speaking there are three types of circular distributions: unimodal, multimodal and uniformly distributed data. Unimodally distributed data is data that contains a single area on the circle in which most of the observations are found. Many statistical tests assume unimodally distributed data. It is however also possible to find multimodal data. This is data in which more than one modal groups are present in the dataset. This may pose a problem if these modal groups all belong to the same set of observations. Uniformly distributed data is a second problematic distribution. In this distribution, observations are spread out entirely over the circular range.

```{r echo=FALSE}
par(mfrow = c(1,3))
plot(c(rvonmises(100, circular(1), 2.5, control.circular=list(units="degrees")), circular(4)), stack = T,
     main = "Unimodally distributed data")

plot(c(rvonmises(50, circular(0), 10, control.circular=list(units="degrees")),rvonmises(50, circular(2), 10, control.circular=list(units="degrees"))), stack = T,
     main = "Bimodally distributed data")

plot(rcircularuniform(100, control.circular=list(units="degrees")), stack = T,
     main = "Uniformly distributed data")
```

Both circular models as well as simple descriptives make assumptions about the distribution of data points on the circle. It is thus always a good idea to plot the dataset before any analysis takes place. Additionally, uniformity of circular data can sometimes be hard to judge just by eye. Data points can be scattered across the circle but still have one or more modal groups. For this reason, it is common practice to test uniformity with a statistical test. A future tutorial will cover some of the possible ways to test uniformity.


##Plotting circular data in R

The `circular` package contains the function `plot.circular` for this purpose. An example of this is given below, using a dataset on flight direction of pigeons. Note how the argument `stack = T` is passed onto the function. The default value for this is `FALSE`, which would result in similar values overlapping. A second useful argument is `sep`, which can be used to specify the amount of seperation between stacked data points. The command `cex` can be used to specify the desired size of the datapoints themselves. The zero point and rotation can also be changed using the arguments `zero` and `rotation`. `zero` requires a value in radians and `rotation` requires the string $"clock"$ or $"counter"$. The example below uses a dataset on pigeon flight directions to demonstrate these arguments.

```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
data <- as.circular(pigeons$bearing, units = "degrees")

plot(x = data, 
     stack = T,
     sep = 0.02,
     cex = 1,
     zero = pi/2,
     rotation = "clock",
     main = "Pigeon flight directions")
```

It can sometimes also be useful to inspect circular data on a continues scale. This can be done by transforming the data from circular to continues using `as.numeric`. Keep in mind that values that are outside of the circular range will need to be calculated down to their remainder using `%%`. Be mindful that a unimodal dataset is not mistaken for a bimodal dataset. In such a scenario one can choose to rescale values.

```{r message=FALSE, warning=FALSE, paged.print=FALSE}
hist(as.numeric(data),
     breaks = 50,
     xlim = c(0,360),
     main = "Pigeon flight directions")
```

## Conclusion

The way that data is distributed on the circle is important to investigate. Under certain distributions descriptives may be inaccurate. Many circular models also make assumptions about the distribution of data that need to be met. In future tutorials we will cover how to deal with data that is distributed in a potentially problematic way. 